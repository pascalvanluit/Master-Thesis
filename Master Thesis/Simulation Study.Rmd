---
title: "Simulation Study"
author: "Pascal van Luit"
date: "13 February 2020"
output: html_document
---

## Exploring the use of the cSEM.DGP package

Installing cSEM and cSEM.DGP packages:
- cSEM pack
```{r}
set.seed(88)
library(lavaan)
library(semPlot)
library(devtools)

devtools::install_github("M-E-Rademaker/cSEM")

devtools::install_github("M-E-Rademaker/cSEM.DGP")
```

Specifying the DGP Model for my simulation study:
```{r}
# Parameters to vary:
lambda <- 0.7
delta  <- 0.4
rho    <- 0.8

# Specifying a DGP model:
DGP.model <- " f1 =~ lambda * x1 + lambda * x2 + lambda * x3 + delta * x4
               f2 =~ lambda * x4 + lambda * x5 + lambda * x6 
               f1 ~~ rho * f2 "

# Fitting the model to a dataset:
fit.DGP <- lavaan::cfa(DGP.model, HolzingerSwineford1939)

# Checking the path diagram:
semPaths(fit.DGP)
```
The above attempt does not quite give me what I want. The arrows are simply labelled but i do not think the values are actually in the labels so to speak.

Below I try it again, but this time with the generateData function from the cSEM.DGP package:
```{r}
DGP.model.2 <- " 
    # Structural model
    f1 ~ rho*f2

    # Measurement model
    f1 =~ lambda*x1 + lambda*x2 + lambda*x3 # + delta*x4
    f2 =~ lambda*x4 + lambda*x5 + lambda*x6 "

DGP.data <- cSEM.DGP::generateData(DGP.model.2, .return_type = "cor",
                                   lambda = c(0.2, 0.5, 0.8),
                                   delta  = c(0.2, 0.5, 0.8),
                                   rho    = c(0.2, 0.5, 0.8),
                                   .handle_negative_definite = "set_NA"
                                   )

DGP.data

DGP.data$dgp[[8]]
```
Problem: Cannot have one indicator be connected to more than one construct.





Example from lavaan package:
```{r}
# specify population model
population.model <- ' f1 =~ x1 + 0.8*x2 + 1.2*x3
                      f2 =~ x4 + 0.5*x5 + 1.5*x6
                      f3 =~ x7 + 0.1*x8 + 0.9*x9

                      f3 ~ 0.5*f1 + 0.6*f2
                    '


# generate data
myData <- simulateData(population.model, sample.nobs = 100L)
head(myData)
cov(myData)

```

